"""
{{server_name}} - MCP Server
{{description}}

Generated by MCP Gateway MCP Template
"""

import random
from datetime import datetime
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI(title="{{server_name}} MCP Server")


class ToolCallRequest(BaseModel):
    tool: str
    arguments: dict


@app.get("/health")
async def health():
    return {"status": "healthy", "service": "{{server_id}}"}


@app.get("/tools")
async def list_tools():
    """List available tools (MCP discovery)."""
    return {
        "tools": [
            {
                "name": "{{tool_1_name}}",
                "description": "{{tool_1_description}}",
                "parameters": {
                    "input": {"type": "string", "description": "Input parameter"}
                }
            },
            {
                "name": "{{tool_2_name}}",
                "description": "{{tool_2_description}}",
                "parameters": {
                    "id": {"type": "string", "description": "Resource ID"}
                }
            }
        ]
    }


@app.post("/call")
async def call_tool(request: ToolCallRequest):
    """Handle tool calls (MCP invocation)."""
    tool = request.tool
    args = request.arguments

    if tool == "{{tool_1_name}}":
        return await {{tool_1_name}}(args.get("input", ""))
    elif tool == "{{tool_2_name}}":
        return await {{tool_2_name}}(args.get("id", ""))
    else:
        return {"error": f"Unknown tool: {tool}"}


async def {{tool_1_name}}(input: str) -> dict:
    """{{tool_1_description}}"""
    # TODO: Implement your logic here
    return {
        "input": input,
        "result": f"Processed: {input}",
        "timestamp": datetime.utcnow().isoformat()
    }


async def {{tool_2_name}}(id: str) -> dict:
    """{{tool_2_description}}"""
    # TODO: Implement your logic here
    return {
        "id": id,
        "data": {"key": "value", "status": "active"},
        "timestamp": datetime.utcnow().isoformat()
    }


if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port={{port}})
